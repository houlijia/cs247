<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T35U3">output</span>, <span class="var type1" id="S3T5U4">cnt</span>, <span class="var type1" id="S4T37U5">errString</span>] = comp_writeUInt( <span class="var type1" id="S5T1U8">val</span>, <span class="var type1" id="S6T17U9">nv</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%COMP_WRITEUINT Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Detailed explanation goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    <span class="mxinfo" id="T37:U6"><span class="var type1" id="S4T37U12">errString</span> =<span class="mxinfo" id="T41:U8"><span class="string">''</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">            <span class="mxinfo" id="T5:U9"><span class="var type1" id="S3T5U16">cnt</span> = <span class="mxinfo" id="T5:U11">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo" id="T6:U12">~isempty(<span class="mxinfo" id="T39:U13">find(<span class="mxinfo" id="T3:U14"><span class="var type1" id="S5T1U26">val</span>&lt;<span class="mxinfo" id="T5:U16">0</span></span>,1)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">                <span class="mxinfo" id="T37:U17"><span class="var type1" id="S4T37U31">errString</span> = <span class="mxinfo" id="T42:U19"><span class="string">'Negative input to writeUInt'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">                <span class="mxinfo" id="T35:U20"><span class="var type1" id="S2T35U35">output</span>=<span class="mxinfo" id="T26:U22">uint8(<span class="mxinfo" id="T5:U23">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">                <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">            <span class="keyword">end</span>                </span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">            <span class="keyword">if</span> islogical(<span class="var type1" id="S5T1U44">val</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">                <span class="var type0" id="S5T0U47">val</span> = uint64(<span class="var type0" id="S5T0U50">val</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">            <span class="keyword">elseif</span> ~isinteger(<span class="var type1" id="S5T1U55">val</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">                <span class="mxinfo" id="T1:U26"><span class="var type1" id="S5T1U58">val</span> = <span class="mxinfo" id="T1:U28">round(<span class="var type1" id="S5T1U61">val</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">            <span class="mxinfo" id="T19:U30"><span class="var type1" id="S5T19U64">val</span> = <span class="mxinfo" id="T19:U32">uint64(<span class="var type1" id="S5T1U67">val</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">            <span class="mxinfo" id="T35:U34"><span class="var type1" id="S2T35U70">output</span> = <span class="mxinfo" id="T35:U36">uint8(<span class="mxinfo" id="T43:U37">zeros(<span class="mxinfo" id="T5:U38">1</span>,<span class="mxinfo" id="T17:U39">8*<span class="var type1" id="S6T17U78">nv</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">            <span class="mxinfo" id="T17:U41"><span class="keyword">for</span> <span class="var type1" id="S15T17U81">k</span>=<span class="mxinfo" id="T17:U43">1</span>:<span class="var type1" id="S6T17U84">nv</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="mxinfo" id="T20:U45"><span class="var type1" id="S16T20U87">vl</span> = <span class="mxinfo" id="T20:U47"><span class="var type1" id="S5T19U89">val</span>(<span class="var type1" id="S15T17U90">k</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo" id="T17:U41">                </span><span class="comment"><span class="mxinfo" id="T17:U41">% First generate an array representing the vector in a</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo" id="T17:U41">                </span><span class="comment"><span class="mxinfo" id="T17:U41">% little endian order, then reverse the array and write it</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo" id="T17:U41">                </span><span class="comment"><span class="mxinfo" id="T17:U41">% out</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="mxinfo" id="T35:U50"><span class="var type1" id="S17T35U93">code</span> = <span class="mxinfo" id="T35:U52">uint8(<span class="mxinfo" id="T43:U53">zeros(<span class="mxinfo" id="T5:U54">1</span>,<span class="var type1" id="S6T17U99">nv</span>)</span>)</span></span>;   </span><span class="comment"><span class="mxinfo" id="T17:U41">% Initial allocation</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="mxinfo" id="T5:U56"><span class="var type1" id="S18T5U102">n</span> = <span class="mxinfo" id="T5:U58">1</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="keyword">while</span> <span class="mxinfo" id="T6:U59"><span class="var type1" id="S16T20U106">vl</span> &gt;=  128</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T26:U61"><span class="mxinfo" id="T26:U62"><span class="var type1" id="S17T35U111">code</span>(<span class="var type1" id="S18T5U112">n</span>)</span> = <span class="mxinfo" id="T20:U65"><span class="mxinfo" id="T20:U66">128</span> + <span class="mxinfo" id="T20:U67">bitand(<span class="var type1" id="S16T20U117">vl</span>,<span class="mxinfo" id="T5:U69">127</span>)</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T20:U70"><span class="var type1" id="S16T20U121">vl</span> = <span class="mxinfo" id="T20:U72">bitshift(<span class="var type1" id="S16T20U124">vl</span>,<span class="mxinfo" id="T5:U74">-7</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T5:U75"><span class="var type1" id="S18T5U129">n</span> = <span class="mxinfo" id="T5:U77"><span class="var type1" id="S18T5U131">n</span>+<span class="mxinfo" id="T5:U79">1</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="keyword">if</span> <span class="mxinfo" id="T6:U80"><span class="var type1" id="S18T5U136">n</span> &gt; <span class="mxinfo" id="T5:U82">1</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T26:U83"><span class="mxinfo" id="T26:U84"><span class="var type1" id="S17T35U141">code</span>(<span class="var type1" id="S18T5U142">n</span>)</span> = <span class="mxinfo" id="T20:U87"><span class="mxinfo" id="T20:U88">128</span> + <span class="var type1" id="S16T20U145">vl</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T26:U90"><span class="mxinfo" id="T26:U91"><span class="var type1" id="S17T35U149">code</span>(<span class="mxinfo" id="T5:U93">1</span>)</span> = <span class="mxinfo" id="T26:U94"><span class="mxinfo" id="T26:U95"><span class="var type1" id="S17T35U153">code</span>(<span class="mxinfo" id="T5:U97">1</span>)</span> - <span class="mxinfo" id="T26:U98">128</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T35:U99"><span class="var type1" id="S17T35U158">code</span> = <span class="mxinfo" id="T35:U101">fliplr(<span class="mxinfo" id="T35:U102"><span class="var type1" id="S17T35U162">code</span>(<span class="mxinfo" id="T5:U104">1</span>:<span class="var type1" id="S18T5U165">n</span>)</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="keyword">else</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo" id="T17:U41">                    <span class="mxinfo" id="T26:U106"><span class="mxinfo" id="T26:U107"><span class="var type1" id="S17T35U170">code</span>(<span class="mxinfo" id="T5:U109">1</span>)</span> = <span class="var type1" id="S16T20U172">vl</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="mxinfo" id="T35:U111"><span class="mxinfo" id="T35:U112"><span class="var type1" id="S2T35U176">output</span>(<span class="mxinfo" id="T1:U114"><span class="mxinfo" id="T5:U115"><span class="var type1" id="S3T5U179">cnt</span>+1</span>:<span class="mxinfo" id="T5:U117"><span class="var type1" id="S3T5U182">cnt</span>+<span class="var type1" id="S18T5U183">n</span></span></span>)</span> = <span class="mxinfo" id="T35:U120"><span class="var type1" id="S17T35U185">code</span>(<span class="mxinfo" id="T5:U122">1</span>:<span class="var type1" id="S18T5U188">n</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo" id="T17:U41">                <span class="mxinfo" id="T5:U124"><span class="var type1" id="S3T5U191">cnt</span> = <span class="mxinfo" id="T5:U126"><span class="var type1" id="S3T5U193">cnt</span> + <span class="var type1" id="S18T5U194">n</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo" id="T17:U41">            <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">            <span class="comment">%err = obj.write(output(1:cnt));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line"></span></span>
</pre>
